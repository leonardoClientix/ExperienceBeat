
<div (click)="exportTableToExcel('tblReporte','prueba')">descargar</div>
<div class="container">
  <div class="row">
    <div class="col-4">
      <h1>Reportes</h1>
    </div>
    <!--<div class="col-8"  >
      <canvas  baseChart *ngIf="doughnutChartData" [data]="doughnutChartData"  chart-labels="labels" [labels]="doughnutChartLabels" [chartType]="doughnutChartType" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
    </div>-->
    <div class="col">

     <!--<table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Nombre</th>
            <th scope="col">E-mail</th>
            <th scope="col">Macro Proceso</th>
            <th scope="col">Cargo</th>
            <th scope="col">NÂ° preguntas contestadas</th>
            <th scope="col">Fecha</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of dataReport; let i = index">
            <th scope="row">{{ i + 1}}</th>
            <td>{{ item.name }}</td>
            <td>{{ item.email }}</td>
            <td>{{ item.macro_process}}</td>
            <td>{{ item.rol}}</td>
            <td  *ngIf="item.question" >
                <label *ngFor="let dt of item.question | keyArray; let i = index">
                  {{ numQuestion(item.question[dt].id) }}
                </label>
            </td>
            <td *ngIf="item.question">{{ item.question[0].date  | date:'d/M/yy - h:mm:ss a ' }}</td>
          </tr>
        </tbody>
      </table>-->

      <table class="table table-striped tb-report" id="tblReporte">
         <thead>
           <tr>
             <th scope="col">Nombre</th>
             <th scope="col">E-mail</th>
             <th scope="col">Macro Proceso</th>
             <th scope="col">Cargo</th>
             <th scope="col">Fecha</th>

             <label *ngFor="let qt of dataQuestions" class="cn-leb">

                 <th class="id">{{ qt.id }}</th>
                 <th class="msg">{{ qt.questions.message }}</th>
                 <label *ngFor="let op of qt.questions.option | keyArray; let o = index" class="cn-leb">

                   <th *ngIf="qt.questions.option[o].typeDesign == 'label'" class="opt lab-text">{{ qt.questions.option[o].options }}</th>

                   <label *ngIf="qt.questions.option[o].typeDesign != 'label'" class="cn-leb">
                     <label *ngFor="let tn of qt.questions.option[o].options | keyArray; let t = index" class="cn-leb">
                       <th class="opt">{{ qt.questions.option[o].options[t] }}</th>
                     </label>
                   </label>

                 </label>

             </label>

           </tr>
         </thead>
         <tbody>
           <label  *ngFor="let item of dataReport; let con = index" class="cn-leb">
           <tr *ngIf="con >= 260 && con <= 270">
             <!--<label class="cn-leb" *ngIf="con >= 320 && con <= 330"> PRIMER BD-->
             <label class="cn-leb" >

             <td>{{ item.name }}</td>
             <td>{{ item.email }}</td>
             <td>{{ item.macro_process}}</td>
             <td>{{ item.rol }}</td>
             <td *ngIf="item.question">{{ item.question[0].date | date:'d/M/yy - h:mm:ss a ' }}</td>

             <label *ngFor="let qt of dataQuestions" class="cn-leb">
               <label *ngFor="let resp of item.question | keyArray; let r = index" class="cn-leb">

                 <label  class="cn-leb">

                     <label *ngIf="item.question[r].id == qt.id" class="cn-leb">
                       <td class="id">{{ qt.id }}</td>
                       <td class="msg">{{ qt.questions.message }}</td>
                     </label>


                     <label *ngFor="let op of qt.questions.option | keyArray; let o = index" class="cn-leb">
                             <label *ngIf="item.question[r].id == qt.id" class="cn-leb">
                               <label *ngIf="qt.questions.option[o].typeDesign != 'label'" class="cn-leb">
                                 <label *ngFor="let tn of qt.questions.option[o].options | keyArray; let t = index" class="cn-leb">
                                   <label *ngIf="item.question[r].options == qt.questions.option[o].options[t]" class="cn-leb col-check">
                                     <td class="opt">{{ item.question[r].options }}</td>
                                   </label>
                                   <td *ngIf="item.question[r].options != qt.questions.option[o].options[t]" class="opt"></td>
                                 </label>
                               </label>
                             </label>

                             <!-- PREGUNTAS DE LA 6 A LA 9 -->

                            <!-- <label *ngIf="item.question[r].id == qt.questions.option[o].id" class="cn-leb">

                               <label *ngIf="r == 5" class="cn-leb">
                                 <td class="id">{{ qt.id }}</td>
                                 <td class="msg">{{ qt.questions.message }}</td>
                               </label>

                             </label>-->


                            <!--<label *ngIf="item.question[r].id == qt.questions.option[o].id" class="cn-leb">

                                 <td class="opt lab-text">{{ item.question[r].option?.label }}</td>

                                 <label *ngIf="item.question[r].option.options" class="cn-leb">
                                   <label *ngFor="let tn of qt.questions.option[o].options | keyArray; let t = index" class="cn-leb">
                                     <label *ngIf="item.question[r].option.options == qt.questions.option[o].options[t]" class="cn-leb col-check">
                                       <td class="opt">{{ item.question[r].option.options }}</td>
                                     </label>
                                     <td *ngIf="item.question[r].option.options != qt.questions.option[o].options[t]" class="opt"></td>
                                   </label>
                                 </label>

                             </label>-->

                     </label> <!--Opciones de la estructura-->

                 </label> <!-- fecha -->
               </label> <!-- lista de respuestas -->
             </label> <!-- Estructura -->


             <!--<label *ngFor="let k of item.question | keyArray; let i = index" class="cn-leb">
               <td>{{ item.question[i].id }}</td>
               <td>{{ item.question[i].message }}</td>
               <td *ngIf="item.question[i].options">{{ item.question[i].options }}</td>
               <td >{{ item.question[i].option?.label }}</td>
               <td>{{ item.question[i].option?.options }}</td>
             </label>-->

             </label>

           </tr>
           </label>
         </tbody>
       </table>

    </div>
  </div>
</div>
