<div *ngIf="loading == false">
<div class="cont-step animated bounceInRight" *ngIf="step == 'basic-parameters'">
<h1>Parametros Básicos</h1>

  <div class="row">

    <div class="col-md-6 mb-6">

        <form [formGroup]="form" class="needs-validation form-list-input" novalidate>

            <div class="form-row">
              <div class="col-md-12 mb-3">
                <label for="validationServer01">Nombre de la encuesta</label>
                <input [(colorPicker)]="quiz.colors.name" class="rad-color ml-2"  name="colorTitle" formControlName="colorTitle" (colorPickerChange)="changeColor('colorTitle',$event)" [style.background]="quiz.colors.name" [style.color]="quiz.colors.name"  />
                <input type="text" class="form-control form-control-lg " id="validationServer01" formControlName="nameQuiz" required  >
              </div> 
              <div class="col-md-12 mb-3">
                <label for="validatedCustomFile">Logo</label>
                <div class="custom-file">   
                    <input type="file" class="custom-file-input" id="validatedCustomFile" name="logo"  formControlName="logo"  (change)="uploadImage($event)" required>
                    <label class="custom-file-label form-control-lg " for="validatedCustomFile" *ngIf="!quiz.logo">Seleccionar archivo...</label>
                    <label class="custom-file-label form-control-lg inp-file" for="validatedCustomFile" *ngIf="quiz.logo">{{ quiz.logo }}</label>
                </div>
              </div>
              <div class="col-md-12 mb-12 mt-3"> 
                <label for="validationTextarea">Descripción</label>
                <ckeditor id="validationTextarea" [editor]="Editor" required formControlName="description"  #dbt></ckeditor>
              </div>
              <div class="col-md-12 mb-12 mt-3"> 
                <label for="initial_textTextarea">Texto Inicial</label>
                <ckeditor id="initial_textTextarea" [editor]="Editor" required formControlName="initial_text" ></ckeditor>
              </div>
              <div class="col-md-12 mb-12 mt-3"> 
                <label for="final_textTextarea">Texto Final</label>
                <ckeditor id="final_textTextarea" [editor]="Editor" required  formControlName="final_text" ></ckeditor>
              </div>
              <div class="col-md-12 mb-3 mt-3">
                <label for="validatedCustomFile_user">Carga de Usuarios</label>
                <div class="custom-file">   
                    <input type="file" class="custom-file-input" #csvReaderUsers name="Upload CSV" id="txtFileUpload" (change)="uploadListener($event,'users')" accept=".csv" >
                    <label class="custom-file-label form-control-lg " for="validatedCustomFile_user" >Seleccionar archivo...</label>
                </div>
              </div>
              <div class="col-md-12 mb-12 mt-3"> 
                <label for="final_textTextarea" class="confg-controls">Campos de entrada <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Configurar campos" data-toggle="modal" data-target="#modalConfigInputs" ></fa-icon> </label>
              </div>
 
              <div class="col-md-12 mb-12 mt-5">
                <h3>Colores de la encuesta</h3>
              </div>
              <div class="col-md-4 mb-3"> 
                <label for="validatedCustomFile">Cabecera</label>
                <input [(colorPicker)]="quiz.colors.header" class="rad-color ml-2"  formControlName="colorHeader" id="color-header"  (colorPickerChange)="changeColor('colorHeader',$event)" [style.background]="quiz.colors.header" [style.color]="quiz.colors.header"/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validatedCustomFile">Fondo</label>
                <input [(colorPicker)]="quiz.colors.background" class="rad-color ml-2" formControlName="colorBackground" id="color-background" (colorPickerChange)="changeColor('colorBackground',$event)" [style.background]="quiz.colors.background" [style.color]="quiz.colors.background"/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validatedCustomFile">Tarjeta Pregunta</label>
                <input [(colorPicker)]="quiz.colors.question" class="rad-color ml-2" formControlName="colorQuestion" id="color-question" (colorPickerChange)="changeColor('colorQuestion',$event)" [style.background]="quiz.colors.question" [style.color]="quiz.colors.question"/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validatedCustomFile">Texto Pregunta</label>
                <input [(colorPicker)]="quiz.colors.txtquestion" class="rad-color ml-2" formControlName="TxtQuestion" id="color-question" (colorPickerChange)="changeColor('TxtQuestion',$event)" [style.background]="quiz.colors.txtquestion" [style.color]="quiz.colors.txtquestion"/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validatedCustomFile">Opciones</label>
                <input [(colorPicker)]="quiz.colors.option" class="rad-color ml-2" formControlName="colorOption" id="color-question" (colorPickerChange)="changeColor('colorOption',$event)" [style.background]="quiz.colors.option" [style.color]="quiz.colors.option"/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validatedCustomFile">Texto Opciones</label>
                <input [(colorPicker)]="quiz.colors.txtoption" class="rad-color ml-2" id="color-question" formControlName="TxtOption" (colorPickerChange)="changeColor('TxtOption',$event)" [style.background]="quiz.colors.txtoption" [style.color]="quiz.colors.txtoption"/>
              </div>
            </div>
        
            
        </form>

    </div>

    <div class="col-md-6 mb-6">

        <div class="box-preview col-md-12" [style.background]="quiz.colors.background" *ngIf="form.controls['initial_text'].value">
          
          <div class="header-preview col-md-12"  [style.background]="quiz.colors.header" [style.color]="quiz.colors.name">
            <img class="logo-preview" [src]="quiz.logo"> {{ form.controls['nameQuiz'].value }}
          </div>

          <div class="col-md-11 mb-11 box-cont txt-center"  [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion">
            <div [innerHTML]="form.controls['initial_text'].value"></div>
            <div class="form-group row mt-4" *ngFor="let itemInp of quiz.inputs; let h = index">             
              <div class="col-sm-12">
                <div class="input-preview"> {{ itemInp.placeholder }} </div>
              </div>
            </div>
          </div>

        </div>
        
        <div class="box-preview col-md-12"  [style.background]="quiz.colors.background" >
            <div class="header-preview col-md-12"  [style.background]="quiz.colors.header" [style.color]="quiz.colors.name" *ngIf="!form.controls['initial_text'].value">
              <img class="logo-preview" [src]="quiz.logo"> {{ form.controls['nameQuiz'].value }}
            </div>
            <div class="col-md-11 mb-11 box-cont"  [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            </div>
            <div class="col-md-11 mb-11 box-cont"  [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            </div>
            <div class="col-md-11 mb-11 box-cont"  [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            </div>
            <div class="col-md-11 mb-11 box-cont"  [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            </div>
        </div>

        <div class="box-preview col-md-12" [style.background]="quiz.colors.background" *ngIf="form.controls['final_text'].value">
          <div class="col-md-11 mb-11 box-cont txt-center" [style.background]="quiz.colors.question" [style.color]="quiz.colors.txtquestion" [innerHTML]="form.controls['final_text'].value"></div>
        </div>

    </div>

  </div>

</div>

<div class="ctr-btns">
  <ul>
    <li><fa-icon [icon]="FA_ICONS.options.faArrowAltCircleRight" class="plus-question"  title="Siguiente" *ngIf="step == 'basic-parameters'" (click)="steps('configuration-questions')" ></fa-icon></li>
  </ul>
</div>

<div class="cont-step animated bounceInRight prev-data" *ngIf="step == 'configuration-questions'">
  <h1>Configuración de Preguntas</h1>

  <form  #forma="ngForm">

  <ngx-sortable [items]="quiz.questions" [listStyle]="listStyle" [showHeader]="false" (listSorted)="listOrderChanged($event)" >
    <ng-template let-item>

        <div class="sortable-list-item">
      
            <div class="row boxQuestion" *ngIf="item.typeDesign == 'message'">
              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <ckeditor [editor]="Editor"  class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [name]="'description_'+item.id" ngModel [(ngModel)]="item.description"></ckeditor>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li><div [colorPicker]="item.colors.question" (colorPickerChange)="item.colors.question = $event" class="rad-color" [style.background]="quiz.colors.question" [style.background]="item.colors.question" id="color-question" title="Tarjeta Pregunta"></div></li>
                  <li><div [colorPicker]="item.colors.txtquestion" (colorPickerChange)="item.colors.txtquestion = $event" class="rad-color"  [style.background]="quiz.colors.txtquestion" [style.background]="item.colors.txtquestion" id="color-question" title="Texto Pregunta"></div></li> 
                  <li> <fa-icon [icon]="FA_ICONS.options.faClone" class="conf-icon"  title="Clonar pregunta" (click)="clonarQuestion(item)"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faAsterisk" class="conf-icon ico-mandatory"  title="Pregunta obligatoria" [ngClass]="{'active': item.mandatory}"  (click)="item.mandatory = !item.mandatory"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faTimes" class="conf-icon"  title="Eliminar pregunta" (click)="deleteQuestion(item.id)"></fa-icon></li>
                </ul>
              </div>
            </div> 


            <div class="row boxQuestion" *ngIf="item.typeDesign == 'multiple_choice'">
              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <ckeditor [editor]="Editor"  class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [name]="'description_'+item.id" ngModel [(ngModel)]="item.description"></ckeditor>
                <div class="resp-limit">
                  <ul>
                    <li><label>Respuestas Max:</label><input type="number" class="num-resp" [name]="'max_resp_'+item.id" [(ngModel)]="item.maximum_responses"></li>
                    <li><label>Respuestas Min:</label><input type="number" class="num-resp" [name]="'min_resp_'+item.id" [(ngModel)]="item.minimal_responses"></li>
                  </ul>
                </div>
                  <div class="list-check">
                    <div class="form-check form-check-inline" *ngFor="let idqs of item.items; let i = index">
                      <input class="form-check-input" type="radio" name="question_{{i}}"  id="inlineCheckbox_{{i}}"  *ngIf="item.responsiveDesign == 'basic'"  #data>
                      <fa-icon *ngIf="item.responsiveDesign == 'faces' || item.responsiveDesign == 'heart'" class="iconDesign" [icon]="selectIconOption(item.responsiveDesign,i)" [style.color]="idqs.color" (mouseover)="idqs.hover=true" (mouseleave)="idqs.hover=false" [ngStyle]="{color: idqs.hover==true  ? item.colorHover : idqs.color  }"></fa-icon>

                      <label class="form-check-label" for="inlineCheckbox_{{i}}">
                        <span translate="no">
                         <input class="input-opt"  *ngIf="item.responsiveDesign != 'square'" [style.color]="quiz.colors.txtoption" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [name]="item.id+'_opt_'+i" [(ngModel)]="idqs.name" />
                         <input class="item_square"  *ngIf="item.responsiveDesign == 'square'"  [style.color]="item.colorFont"  [name]="item.id+'_opt_'+i" [(ngModel)]="idqs.name" (mouseover)="idqs.hover=true" (mouseleave)="idqs.hover=false" [ngStyle]="{background: idqs.hover==true  ? item.colorHover : idqs.color  }" />
                        </span>
                      </label>

                      <div  class="min-icon"  title="Eliminar Opción" (click)="removeOpt(item,'multiple_choice',i)">-</div> 
                    </div>

                    <div *ngIf="item.responsiveDesign == 'slider'" class="col-md-12 content-slider">
                      <mat-slider min="item.items[0].name" [max]="item.items[item.items?.length-1].name"  [step]="item.items[1].name-item.items[0].name" thumbLabel   [style.color]="sliColor(item.color,idSlider) " #idSlider></mat-slider>
                    </div>
                   
                
                  </div> 

              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li><div [colorPicker]="item.colors.question" (colorPickerChange)="item.colors.question = $event" class="rad-color" [style.background]="item.colors.question" [style.background]="quiz.colors.question" id="color-question" title="Tarjeta Pregunta"></div></li>
                  <li><div [colorPicker]="item.colors.txtquestion" (colorPickerChange)="item.colors.txtquestion = $event" class="rad-color" [style.background]="item.colors.txtquestion" [style.background]="quiz.colors.txtquestion"id="color-question" title="Texto Pregunta"></div></li> 
                  <li> <fa-icon [icon]="FA_ICONS.options.faClone" class="conf-icon" title="Clonar pregunta" (click)="clonarQuestion(item)"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faAsterisk" class="conf-icon ico-mandatory"  title="Pregunta obligatoria" [ngClass]="{'active': item.mandatory}"  (click)="item.mandatory = !item.mandatory"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon" title="Editar pregunta" data-toggle="modal" data-target="#modalEditQuestion" (click)="modalEditQuestion(item)"></fa-icon></li>    
                  <li> 
                    <fa-icon [icon]="FA_ICONS.options.faPlus" class="conf-icon item-left" title="Agregar Opción" (click)="addOpt(item,'multiple_choice')"></fa-icon>
                    <ul class="sub-controls">
                      <li> <fa-icon [icon]="FA_ICONS.options.faExclamationCircle" class="conf-icon" title="Ninguna de las Opciones" (click)="addOpt(item,'multiple_choice','none')"></fa-icon></li>
                      <li> <fa-icon [icon]="FA_ICONS.options.faNetworkWired" class="conf-icon" title="Otra opción" (click)="addOpt(item,'multiple_choice','other')"></fa-icon></li>
                    </ul>
                  </li>    
                  <li> <fa-icon [icon]="FA_ICONS.options.faTimes" class="conf-icon"  title="Eliminar pregunta" (click)="deleteQuestion(item.id)"></fa-icon></li>
                </ul>
              </div>
            </div> 

            <div class="row boxQuestion" *ngIf="item.typeDesign == 'check_label'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <ckeditor [editor]="Editor"  class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [name]="'description_'+item.id" ngModel [(ngModel)]="item.description"></ckeditor>
       
                  <div class="list-check">
                    <div class="row">
                      <div class="col-md-6" *ngFor="let lab of item.items; let l = index">
                        <div class="row">
                            <div class="label-option col-md-3">
                              <input class="input-opt" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l" [(ngModel)]="lab.label"/>
                            </div>
                            <div class="items-options-list col-md-3">
                              <div class="form-check form-check-inline" *ngFor="let idqs of item.items[l].options; let i = index">
                                <input class="form-check-input inp-checkbox" type="radio" name="question_{{i}}"  id="inlineCheckbox_{{i}}" #dataCkMensaje>
                                <label class="form-check-label" for="inlineCheckbox_{{i}}" ><span translate="no"><input name="opnum" class="input-opt" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l+'_opt_'+i" [(ngModel)]="idqs.name"/></span></label>
                                <div  class="min-icon"  title="Eliminar Opción" (click)="removeOpt(item.items[l],'check_label',i)">-</div> 
                              </div>
                              <ul class="confg-controls ind-cont">
                                <li><fa-icon [icon]="FA_ICONS.options.faPlus" class="conf-icon" title="Agregar Opción" (click)="addOptLabel(item.items[l],'check_label')"></fa-icon></li>
                              </ul>
                            </div>
                        </div>
                      </div>
                    </div>
                  </div> 
              </div>

              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li><div [colorPicker]="item.colors.question" (colorPickerChange)="item.colors.question = $event" class="rad-color" [style.background]="item.colors.question" [style.background]="quiz.colors.question" id="color-question" title="Tarjeta Pregunta"></div></li>
                  <li><div [colorPicker]="item.colors.txtquestion" (colorPickerChange)="item.colors.txtquestion = $event" class="rad-color" [style.background]="item.colors.txtquestion" [style.background]="quiz.colors.txtquestion" id="color-question" title="Texto Pregunta"></div></li> 
                  <li> <fa-icon [icon]="FA_ICONS.options.faClone" class="conf-icon"  title="Clonar pregunta" (click)="clonarQuestion(item)" ></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faAsterisk" class="conf-icon ico-mandatory"  title="Pregunta obligatoria" [ngClass]="{'active': item.mandatory}"  (click)="item.mandatory = !item.mandatory"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" ></fa-icon></li>    
                  <li><fa-icon [icon]="FA_ICONS.options.faPlus" class="conf-icon" title="Agregar Opción" (click)="addOpt(item,'check_label')"></fa-icon></li>   
                  <li> <fa-icon [icon]="FA_ICONS.options.faTimes" class="conf-icon"  title="Eliminar pregunta" (click)="deleteQuestion(item.id)"></fa-icon></li>     
                </ul>
              </div>

            </div> 


            <div class="row boxQuestion" *ngIf="item.typeDesign == 'open_question'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <ckeditor [editor]="Editor"  class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" name="description_{{item.id}}" ngModel [(ngModel)]="item.description"></ckeditor>
                <textarea class="cont-question-txt"></textarea>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li><div [colorPicker]="item.colors.question" (colorPickerChange)="item.colors.question = $event" class="rad-color" [style.background]="quiz.colors.question" [style.background]="item.colors.question" id="color-question" title="Tarjeta Pregunta"></div></li>
                  <li><div [colorPicker]="item.colors.txtquestion" (colorPickerChange)="item.colors.txtquestion = $event" class="rad-color" [style.background]="quiz.colors.txtquestion" [style.background]="item.colors.txtquestion"  id="color-question" title="Texto Pregunta"></div></li> 
                  <li> <fa-icon [icon]="FA_ICONS.options.faClone" class="conf-icon"  title="Clonar pregunta" (click)="clonarQuestion(item)"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faAsterisk" class="conf-icon ico-mandatory"  title="Pregunta obligatoria" [ngClass]="{'active': item.mandatory}"  (click)="item.mandatory = !item.mandatory"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" ></fa-icon></li>    
                  <li> <fa-icon [icon]="FA_ICONS.options.faTimes" class="conf-icon"  title="Eliminar pregunta" (click)="deleteQuestion(item.id)"></fa-icon></li>
                </ul>
              </div>

            </div> 

          
            <div class="row boxQuestion style-table" *ngIf="item.typeDesign == 'table'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <ckeditor [editor]="Editor"  class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" name="description_{{item.id}}" ngModel [(ngModel)]="item.description"></ckeditor>
                <div class="row cont-table">
                  <div class="col-md-4 mb-4 box-fixed">
                    <div class="col-md-12 mb-12 tr head-table"></div>
                    <div *ngFor="let lab of item.items; let l = index">
                      <div class="col-md-12 mb-12 tr head-table">
                        <input class="input-opt w-full" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l" [(ngModel)]="lab.label"/>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-12 mb-12">
                    
                    <div *ngFor="let lab of item.items; let l = index" class="free-fixed row">

                      <div *ngIf="l == 0" class="w-full">
                        <ul class="confg-controls conf-int">
                          <li><fa-icon [icon]="FA_ICONS.options.faPlus" class="conf-icon" title="Agregar Opción" (click)="addOptLabel(item.items[l],'table')"></fa-icon></li>
                        </ul>
                        <div  *ngFor="let idqs of item.items[l].options; let i = index" class="col-md-4 col-td">
                          <div class="row" >
                            <div class="col-md-12 mb-12 tr head-table">
                              <input  class="input-opt w-full" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l+'_opt_'+i" [(ngModel)]="idqs.name"/>
                            </div> 
                          </div>
                          <div class="row" *ngFor="let lab of item.items; let d = index">
                            <div class="col-md-4 mb-4 td"></div>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li><div [colorPicker]="item.colors.question" (colorPickerChange)="item.colors.question = $event" class="rad-color" [style.background]="quiz.colors.question" [style.background]="item.colors.question" id="color-question" title="Tarjeta Pregunta"></div></li>
                  <li><div [colorPicker]="item.colors.txtquestion" (colorPickerChange)="item.colors.txtquestion = $event" class="rad-color" [style.background]="item.colors.txtquestion" [style.background]="quiz.colors.txtquestion" id="color-question" title="Texto Pregunta"></div></li> 
                  <li> <fa-icon [icon]="FA_ICONS.options.faClone" class="conf-icon"  title="Clonar pregunta" (click)="clonarQuestion(item)"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faAsterisk" class="conf-icon ico-mandatory"  title="Pregunta obligatoria" [ngClass]="{'active': item.mandatory}"  (click)="item.mandatory = !item.mandatory"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" ></fa-icon></li>    
                  <li><fa-icon [icon]="FA_ICONS.options.faPlus" class="conf-icon" title="Agregar Opción" (click)="addOpt(item,'table')"></fa-icon></li>
                  <li> <fa-icon [icon]="FA_ICONS.options.faTimes" class="conf-icon"  title="Eliminar pregunta" (click)="deleteQuestion(item.id)"></fa-icon></li>
                </ul>
              </div>

            </div> 


        </div>

    </ng-template>
</ngx-sortable>
</form>

</div>

<div class="cont-step animated bounceInRight" *ngIf="step == 'conditional-questions'">
  <h1>Condicionales y Alertas</h1>

  <form  #forma="ngForm">

  <div *ngFor="let item of quiz.questions; let idQ = index">
  
            <div class="row boxQuestion" *ngIf="item.typeDesign == 'message'">
              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <div class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [innerHTML]="item.description"></div>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon" title="Editar pregunta" data-toggle="modal" data-target="#modalConditionalQuestion" (click)="openModalConfigQuestion(item.id,item)"></fa-icon></li>   
                </ul>
              </div>
            </div> 

            <div class="row boxQuestion" *ngIf="item.typeDesign == 'multiple_choice'">
              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <div class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [innerHTML]="item.description"></div>
        
                  <div class="list-check">

                    <div class="form-check form-check-inline" *ngFor="let idqs of item.items; let i = index">

                        <div *ngIf="item.responsiveDesign == 'basic'">
                          <input class="form-check-input" type="radio" name="question_{{i}}"   id="inlineCheckbox_{{i}}" #data>
                          <label class="form-check-label" for="inlineCheckbox_{{i}}" >
                            <span translate="no">
                            <div [style.color]="quiz.colors.txtoption" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion">{{ idqs.name }}</div>
                            </span>
                          </label>
                        </div>

                        <div *ngIf="item.responsiveDesign == 'faces' || item.responsiveDesign == 'heart'">
                          <fa-icon class="iconDesign" [icon]="selectIconOption(item.responsiveDesign,i)" [style.color]="idqs.color" (mouseover)="idqs.hover=true" (mouseleave)="idqs.hover=false" [ngStyle]="{color: idqs.hover==true  ? item.colorHover : idqs.color  }"></fa-icon>
                        </div>

                        <div *ngIf="item.responsiveDesign == 'square'">
                          <label (mouseover)="idqs.hover=true" (mouseleave)="idqs.hover=false" [style.color]="item.colorFont" [ngStyle]="{background: idqs.hover==true  ? item.colorHover : idqs.color }" class="form-check-label item_square" for="optDesig_4_{{i}}">{{ idqs.name }}</label>
                        </div>
                        
                    </div>

                    <div *ngIf="item.responsiveDesign == 'slider'" class="content-slider">
                      <mat-slider min="item.items[0].name" [max]="item.items[item.items?.length-1].name"  [step]="item.items[1].name-item.items[0].name" thumbLabel   [style.color]="sliColor(item.color,idSlider) " #idSlider></mat-slider>
                    </div>

                  </div> 

              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon" title="Editar pregunta" data-toggle="modal" data-target="#modalConditionalQuestion" (click)="openModalConfigQuestion(item.id,item)" ></fa-icon></li>       
                </ul>
              </div>
            </div> 

            <div class="row boxQuestion" *ngIf="item.typeDesign == 'check_label'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <div class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [innerHTML]="item.description"></div>
       
                  <div class="list-check">
                    <div class="row">
                      <div class="col-md-6" *ngFor="let lab of item.items; let l = index">
                        <div class="row">
                            <div class="label-option col-md-3">
                              <input class="input-opt" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l" [(ngModel)]="lab.label"/>
                            </div>
                            <div class="items-options-list col-md-3">
                              <div class="form-check form-check-inline" *ngFor="let idqs of item.items[l].options; let i = index">
                                <input class="form-check-input inp-checkbox" type="radio" name="question_{{i}}"   id="inlineCheckbox_{{i}}" #dataCkMensaje>
                                <label class="form-check-label" for="inlineCheckbox_{{i}}" ><span translate="no"><input name="opnum" class="input-opt" [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" [name]="item.id+'_label_'+l+'_opt_'+i" [(ngModel)]="idqs.name"/></span></label> 
                              </div>
                            </div>
                        </div>
                      </div>
                    </div>
                  </div> 

              </div>

              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" data-toggle="modal" data-target="#modalConditionalQuestion" (click)="openModalConfigQuestion(item.id,item)" ></fa-icon></li>     
                </ul>
              </div>

            </div> 


            <div class="row boxQuestion" *ngIf="item.typeDesign == 'open_question'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <div class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [innerHTML]="item.description"></div>
                <textarea class="cont-question-txt"></textarea>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" data-toggle="modal" data-target="#modalConditionalQuestion" (click)="openModalConfigQuestion(idQ,item)"></fa-icon></li>    
                </ul>
              </div>

            </div> 

          
            <div class="row boxQuestion style-table" *ngIf="item.typeDesign == 'table'">

              <div class="col-md-11 mb-11 cont-itemquestion" [style.background]="quiz.colors.question" [style.background]="item.colors.question">
                <div class="cont-question" [style.color]="quiz.colors.txtquestion" [style.color]="item.colors.txtquestion" [innerHTML]="item.description"></div>
                <div class="row cont-table">
                  <div class="col-md-4 mb-4 box-fixed">
                    <div class="col-md-12 mb-12 tr head-table"></div>
                    <div *ngFor="let lab of item.items; let l = index">
                      <div class="col-md-12 mb-12 tr head-table">
                        <div  [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion">{{ lab.label }}</div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-12 mb-12">
                    
                    <div *ngFor="let lab of item.items; let l = index" class="free-fixed row">

                      <div *ngIf="l == 0" class="w-full">
                        
                        <div  *ngFor="let idqs of item.items[l].options; let i = index" class="col-md-4 col-td">
                          <div class="row" >
                            <div class="col-md-12 mb-12 tr head-table">
                              <div [style.color]="quiz.colors.txtoption" [style.color]="item.colors.txtquestion" >{{ idqs.name }}</div>
                            </div> 
                          </div>
                          <div class="row" *ngFor="let lab of item.items; let d = index">
                            <div class="col-md-4 mb-4 td"></div>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-1 mb-1">
                <ul class="confg-controls">
                  <li> <fa-icon [icon]="FA_ICONS.options.faEdit" class="conf-icon"  title="Editar pregunta" data-toggle="modal" data-target="#modalConditionalQuestion" (click)="openModalConfigQuestion(item.id,item)" ></fa-icon></li>          
                </ul>
              </div>

            </div> 

  </div>
</form>

</div>

<div class="ctr-btns">
  <ul>
    <li><fa-icon [icon]="FA_ICONS.options.faArrowAltCircleLeft" class="plus-question"  title="Atrás" *ngIf="step == 'configuration-questions'" (click)="steps('basic-parameters')" ></fa-icon></li>
    <li><fa-icon [icon]="FA_ICONS.options.faArrowAltCircleRight" class="plus-question"  title="Siguiente" *ngIf="step == 'configuration-questions'" (click)="steps('conditional-questions')" ></fa-icon></li>
    <li><fa-icon [icon]="FA_ICONS.options.faSave" class="plus-question"  title="Guardar Encuesta" *ngIf="step == 'configuration-questions'"  (click)="saveQuizQuestion()"></fa-icon></li>
    <li><fa-icon [icon]="FA_ICONS.options.faPlusCircle" class="plus-question"  title="Agregar Pregunta" *ngIf="step == 'configuration-questions'"  data-toggle="modal" data-target="#exampleModalCenter" (click)="modalTypeQuestion = true"></fa-icon></li>

    <li><fa-icon [icon]="FA_ICONS.options.faArrowAltCircleLeft" class="plus-question"  title="Atrás" *ngIf="step == 'conditional-questions'" (click)="steps('configuration-questions')" ></fa-icon></li>
    <li><fa-icon [icon]="FA_ICONS.options.faCheckCircle" class="plus-question"  title="Finalizar" *ngIf="step == 'conditional-questions'"  ></fa-icon></li>
  </ul>
</div>

<div  class="modal" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" >

<!-- <form [formGroup]="formTypeQuestion" (ngSubmit)="typeQuestion()" class="needs-validation" novalidate> -->

  <form #formType="ngForm">

  <div class="modal-dialog modal-lg modal-dialog-centered" role="document"> 
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="exampleModalCenterTitle">Nuevo Componente</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="container-fluid">

          <div class="row">
            <div class="col-md-6">

              <div class="custom-control custom-radio">
                <input type="radio" id="message" name="typeQuestion" class="custom-control-input"  value="message" ngModel>
                <label class="custom-control-label" for="message">Mensaje</label>
              </div>

            </div>
            <div class="col-md-6">
              <img src="https://i.pinimg.com/originals/da/c8/d4/dac8d4cb582558f281b6d0e1711c4838.gif" class="img-quiestion-type">
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">

              <div class="custom-control custom-radio">
                <input type="radio" id="open_question" name="typeQuestion" class="custom-control-input"  value="open_question" ngModel>
                <label class="custom-control-label" for="open_question">Pregunta Abierta</label>
              </div>

            </div>
            <div class="col-md-6">
              <img src="https://i.pinimg.com/originals/da/c8/d4/dac8d4cb582558f281b6d0e1711c4838.gif" class="img-quiestion-type">
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">

              <div class="custom-control custom-radio">
                <input type="radio" id="multiple_choice" name="typeQuestion" class="custom-control-input"  value="multiple_choice" ngModel>
                <label class="custom-control-label" for="multiple_choice">Selección Multiple</label>
              </div>

            </div>
            <div class="col-md-6">
              <img src="https://i.pinimg.com/originals/b9/83/17/b98317fb6a4557174555cd3330aba443.gif" class="img-quiestion-type">
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">

              <div class="custom-control custom-radio">
                <input type="radio" id="multiple_choice_table" name="typeQuestion" class="custom-control-input"   value="table" ngModel>
                <label class="custom-control-label" for="multiple_choice_table">Tabla</label>
              </div>

            </div>
            <div class="col-md-6">
              <img src="https://i.pinimg.com/originals/9e/58/94/9e58940d4cafe94af5521b018e8a601e.gif" class="img-quiestion-type">
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">

              <div class="custom-control custom-radio">
                <input type="radio" id="label_check" name="typeQuestion" class="custom-control-input"  value="check_label" ngModel>
                <label class="custom-control-label" for="label_check">Label check</label>
              </div>

            </div>
            <div class="col-md-6">
              <img src="https://i.pinimg.com/originals/9e/58/94/9e58940d4cafe94af5521b018e8a601e.gif" class="img-quiestion-type">
            </div>
          </div>

        </div>
      </div>

      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="typeQuestion(formType)" data-dismiss="modal">Seleccionar</button>
        <div   #closeBtn></div>
      </div>
    </div>
  </div>

</form>

</div>


  <div class="modal" id="modalConfigInputs" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" >

    <form #formInput="ngForm" class="needs-validation" novalidate>
    
      <div class="modal-dialog modal-lg modal-dialog-centered" role="document"> 
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title" id="exampleModalCenterTitle">Editar Configuración</h2>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
    
          <div class="modal-body">
            <div class="container-fluid">
              <div  class="cont-input">
                  <div class="col-sm-12">
                    <div class="row">
                    <div class="col-sm-10">
                      <p class="mini-txt">Los campos configurados a continuación saldrán antes de comenzar la encuesta despues del texto inicial</p>
                    </div>
                    <div class="col-sm-2">
                      <fa-icon [icon]="FA_ICONS.options.faPlus" title="Agregar Input" class="icon-condi" (click)="addInputType()"></fa-icon>
                    </div> 
                    </div>
                  </div>
                 
                  <div class="form-group row mt-4" *ngFor="let itemInp of quiz.inputs; let h = index">

                    <label for="colFormLabel" class="col-sm-3 col-form-label">Nombre del campo</label>
                    <div class="col-sm-5">
                      <input type="text" class="form-control" id="colFormLabel{{h}}" name="colFormLabel{{h}}" [(ngModel)]="itemInp.placeholder" (keyup)="itemInp.name = itemInp.placeholder">
                      <div class="push_input"  *ngIf="itemInp.name != ' '"> {{ itemInp.name }} </div>
                    </div>
                    <div class="col-sm-4">
                      <fa-icon [icon]="FA_ICONS.options.faBook" title="Seleccionar campo de la base de datos" class="icon-condi px-2" (click)="selectInput(itemInp)"></fa-icon>  
                      <fa-icon [icon]="FA_ICONS.options.faTimesCircle" title="Seleccionar campo de la base de datos" class="icon-condi px-2" (click)="deleteInput(quiz.inputs,h)"></fa-icon> 
                    </div>
                     
                    <div class="box-list-input" *ngIf="itemInp.selAct">
                      <div class="list-group" *ngFor="let item of listObj; let w = index" >
                        <div class="list-group-item list-group-item-action" *ngIf="listObj[w] != 'configQuiz'"  (click)="saveTypeInput(listObj[w],itemInp)">{{ listObj[w] }}</div>
                      </div>
                    </div>

                  </div>             
              </div>
            </div>
          </div>
    
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary" data-dismiss="modal" >Guardar</button>
           
          </div>
        </div>
      </div>
    
    </form>
    
    </div>

    <div class="modal" id="modalEditQuestion" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" >

      <form #formDesign="ngForm" class="needs-validation" novalidate>
        <!-- <form #formDesign="ngForm" (ngSubmit)="configDesign(formDesign)" class="needs-validation" novalidate> -->
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document"> 
          <div class="modal-content">
            <div class="modal-header">
              <h2 class="modal-title" id="exampleModalCenterTitle">Editar Pregunta</h2>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>

            <div class="modal-body">
              <div class="container-fluid">

                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="design-tab" data-toggle="tab" href="#design" role="tab" aria-controls="design" aria-selected="false">Diseño</a>
                  </li>
                </ul>

                <div class="tab-content" id="myTabConditional">
                  
                  <div class="tab-pane tap-conf fade show active" id="design" role="tabpanel" aria-labelledby="design-tab">
                    
                    <h3>Diseño de Respuesta</h3>
                    <div class="row">
                      <div class="col-md-3 pl-4 p-3">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" id="design_1" name="configModalDesign.responsiveDesign" value="basic" checked [(ngModel)]="configModalDesign.responsiveDesign">
                          <label class="form-check-label" for="design_1">Básico</label>
                        </div>
                      </div>
                      <div class="col-md-6 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'basic'"></div>
                        <div class="form-check form-check-inline" *ngFor="let dat of configModalDesign.items; let i = index">
                          <input class="form-check-input" type="checkbox" id="optDesig_1_{{i}}" value="option1">
                          <label class="form-check-label" for="optDesig_1_{{i}}">{{ dat.name }}</label>
                        </div>
                      </div>
                      <div class="col-md-3 p-3">
                      </div>
                    </div>  

                    <div class="row">
                      <div class="col-md-3 p-4">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" id="design_2" name="configModalDesign.responsiveDesign" value="faces" [(ngModel)]="configModalDesign.responsiveDesign">
                          <label class="form-check-label" for="design_2">Caras</label>
                        </div>
                      </div>
                      <div class="col-md-6 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'faces'"></div>
                        <div class="form-check form-check-inline" *ngFor="let dat of configModalDesign.items; let f = index">
                           <label class="form-check-label" id="optDesig_2_{{f}}"><fa-icon [(colorPicker)]="dat.color" [icon]="selectIconOption('faces',f)" class="icon-response" id="icon-opt_2_{{f}}" (mouseover)="dat.hover=true" (mouseleave)="dat.hover=false" [ngStyle]="{color: dat.hover==true  ? configModalDesign.colorHover : dat.color  }" ></fa-icon></label>
                        </div>
                      </div>
                      <div class="col-md-3 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'faces'"></div>
                        <div [(colorPicker)]="configModalDesign.colorHover" class="rad-color color-horizon ml-2"  [style.background]="configModalDesign.colorHover" [style.color]="configModalDesign.colorHover"></div>
                      </div>
                    </div> 
                    
                    <div class="row">
                      <div class="col-md-3 p-4">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" id="design_3" name="configModalDesign.responsiveDesign" value="heart" [(ngModel)]="configModalDesign.responsiveDesign">
                          <label class="form-check-label" for="design_3">Corazones</label>
                        </div>
                      </div>
                      <div class="col-md-6 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'heart'"></div>
                        <div class="form-check form-check-inline" *ngFor="let dat of configModalDesign.items; let f = index">
                          <label class="form-check-label" id="optDesig_3_{{f}}"><fa-icon [(colorPicker)]="dat.color" [icon]="selectIconOption('heart',f)" class="icon-response" id="icon-opt_3_{{f}}" (mouseover)="dat.hover=true" (mouseleave)="dat.hover=false" [ngStyle]="{color: dat.hover==true  ? configModalDesign.colorHover : dat.color }"  ></fa-icon></label>
                        </div>
                      </div>
                      <div class="col-md-3 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'heart'"></div>
                        <div [(colorPicker)]="configModalDesign.colorHover" class="rad-color color-horizon ml-2"  [style.background]="configModalDesign.colorHover" [style.color]="configModalDesign.colorHover"></div>
                      </div>
                    </div> 

                    <div class="row">
                      <div class="col-md-3 p-4">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" id="design_4" name="configModalDesign.responsiveDesign" value="square" [(ngModel)]="configModalDesign.responsiveDesign">
                          <label class="form-check-label" for="design_4">Cuadros</label>
                        </div>
                      </div>

                      <div class="col-md-6 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'square'"></div>
                        <div class="form-check form-check-inline m-1" *ngFor="let dat of configModalDesign.items; let i = index">
                          <label [(colorPicker)]="dat.color" (mouseover)="dat.hover=true" (mouseleave)="dat.hover=false" [style.color]="configModalDesign.colorFont" [ngStyle]="{background: dat.hover==true  ? configModalDesign.colorHover : dat.color }" class="form-check-label item_square" for="optDesig_4_{{i}}">{{ dat.name }}</label>
                        </div>
                      </div>
 
                      <div class="col-md-3 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'square'"></div>
                        <div [(colorPicker)]="configModalDesign.colorHover" class="rad-color color-horizon ml-2"  [style.background]="configModalDesign.colorHover" [style.color]="configModalDesign.colorHover"></div>
                        <div [(colorPicker)]="configModalDesign.colorFont" class="rad-color color-horizon ml-2"  [style.background]="configModalDesign.colorFont" [style.color]="configModalDesign.colorFont"></div>
                      </div>
                    </div> 

                    <div class="row">
                      <div class="col-md-3 p-4">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" id="design_4" name="configModalDesign.responsiveDesign" value="slider" [(ngModel)]="configModalDesign.responsiveDesign">
                          <label class="form-check-label" for="design_4">Barra</label>
                        </div>
                      </div>

                      <div class="col-md-6 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'slider'"></div>
                        <div class="form-check form-check-inline m-1" *ngIf="configModalDesign.items?.length > 0">
                          <mat-slider min="configModalDesign.items[0].name" [max]="configModalDesign.items[configModalDesign.items?.length-1].name"  [step]="configModalDesign.items[1].name-configModalDesign.items[0].name" thumbLabel  #sliData></mat-slider>
                        </div>
                      </div>

                      <div class="col-md-3 p-3">
                        <div class="tab-hidden" *ngIf="configModalDesign.responsiveDesign != 'slider'"></div>
                        <div [(colorPicker)]="configModalDesign.color" class="rad-color color-horizon ml-2"  [style.background]="configModalDesign.color" (colorPickerChange)="sliColor(configModalDesign.color)"></div>
                      </div>
                    </div> 

                  </div>

                </div>

              </div>
            </div>

            <div class="modal-footer">
              <button type="submit" class="btn btn-primary" (click)="configModalDesign.send = true">Seleccionar</button>
              <div  data-dismiss="modal" #closeBtn></div>
            </div>
           </div>
          </div>

      </form>

    </div>

    <div class="modal" id="modalConditionalQuestion" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" >

      <form #formConditional="ngForm" (ngSubmit)="configQuestion(formConditional)" class="needs-validation" novalidate>
      
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document"> 
          <div class="modal-content">
            <div class="modal-header">
              <h2 class="modal-title" id="exampleModalCenterTitle">Editar Configuración</h2>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
      
            <div class="modal-body">
              <div class="container-fluid">
  
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Condicionales</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Alertas</a>
                  </li>
                  <li class="nav-item" *ngIf="configModalQuestion.typeDesign == 'check_label' || configModalQuestion.typeDesign == 'multiple_choice'">
                    <a class="nav-link" id="design-tab" data-toggle="tab" href="#design" role="tab" aria-controls="design" aria-selected="false">Diseño</a>
                  </li>
                </ul>
                <div class="tab-content" id="myTabConditional">
                  <div class="tab-pane tap-conf fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
  
                    <h3>Tipo de Condición</h3>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" id="inlineCheckbox1" name="typeConditional" value="input_data" (change)="configModalQuestion.typeConditional = 'input_data'" [checked]="configModalQuestion.typeConditional == 'input_data'" ngModel>
                      <label class="form-check-label" for="inlineCheckbox1">Datos de entrada</label>
                    </div>
                    
                    <div class="form-check form-check-inline" *ngIf="configModalQuestion.typeDesign != 'message' && configModalQuestion.typeDesign != 'open_question' ">
                      <input class="form-check-input" type="radio" id="inlineCheckbox2" name="typeConditional" value="response" (change)="configModalQuestion.typeConditional = 'response'" [checked]="configModalQuestion.typeConditional == 'response'" ngModel>
                      <label class="form-check-label" for="inlineCheckbox2">Respuesta</label>
                    </div>
  
                    <div *ngIf="configModalQuestion.typeConditional">
  
                      <div  class="cont-input">
  
                        <div *ngIf="configModalQuestion.typeConditional == 'input_data'">
  
                          <div class="col-sm-12">
                            <div class="row">
                            <div class="col-sm-10">
                              <p class="mini-txt">Los campos configurados a continuación saldrán antes de comenzar la encuesta </p>
                            </div>
                            <div class="col-sm-2">
                              <fa-icon [icon]="FA_ICONS.options.faPlus" title="Agregar Input" class="icon-condi" (click)="addInputType()"></fa-icon>
                            </div> 
                            </div>
                          </div>
                          <div class="form-group row mt-4" *ngFor="let itemInp of quiz.inputs; let h = index">
                            <label for="colFormLabel" class="col-sm-3 col-form-label">Nombre del campo</label>
                            <div class="col-sm-5">
                              <input type="text" class="form-control" id="colFormLabel{{h}}" name="colFormLabel{{h}}" [(ngModel)]="itemInp.placeholder">
                              <div class="push_input"  *ngIf="itemInp.name != ' '"> {{ itemInp.name }} </div>
                            </div>
                            <div class="col-sm-4">

                              <fa-icon [icon]="FA_ICONS.options.faBook" title="Seleccionar campo de la base de datos" class="icon-condi px-2" (click)="selectInput(itemInp)"></fa-icon>     
                              <fa-icon [icon]="FA_ICONS.options.faExchangeAlt" title="Buscar datos relacionados" class="icon-condi px-2" (click)="getUsers(itemInp)" #getUser></fa-icon> 

                              <input type="file" class="custom-file-input" #csvRelatedInput name="Upload CSV" id="uploadInputsRelated" (change)="uploadRelatedInput($event,h,itemInp,formConditional)" accept=".csv" >
                              <fa-icon [icon]="FA_ICONS.options.faUpload" title="Subir datos relacionados" class="icon-condi px-2" for="uploadInputsRelated" (click)="uploadRelatedInput()"></fa-icon> 

                              <fa-icon [icon]="FA_ICONS.options.faTimesCircle" title="Eliminar campo" class="icon-condi px-2" (click)="deleteInput(quiz.inputs,h)"></fa-icon>

                              <ng-select *ngIf="itemInp.selFilter" [multiple]="true" name="selectedFilterInput{{ h }}" ngModel  placeholder="Filtrar por : "  (change)="saveFilterUserQuestion( $event, itemInp.name  )">
                                <ng-option *ngFor="let udat of dataDuplicate(listUsers,itemInp.name)" [value]="udat"  selected>{{ udat }}</ng-option>
                              </ng-select>

                            </div>

                            <div class="box-list-input" *ngIf="itemInp.selAct" >
                              <div class="list-group" *ngFor="let item of listObj; let w = index" >
                                <div class="list-group-item list-group-item-action" *ngIf="listObj[w] != 'configQuiz'"  (click)="saveTypeInput(listObj[w],itemInp)">{{ listObj[w] }}</div>
                              </div>
                            </div>

                          </div>
                          
                        </div>

                        <div *ngIf="configModalQuestion.typeConditional == 'response'">
                          <div class="col-sm-12">
                            <div class="row">
                              <div class="col-sm-2">Valor</div>
                              <div class="col-sm-4">Condición</div>
                              <div class="col-sm-6">Preguntas</div>
                            </div>
                            <div class="row" *ngFor="let dat of configModalQuestion.items">
                              <div class="col-sm-2">{{ dat.name }}</div>
                              <div class="col-sm-4">
                                <select class="form-control" id="exampleFormControlSelect1">
                                  <option selected>Filtrar por pregunta</option>
                                </select>
                              </div>
                              <div class="col-sm-6" class="list-filter-question">
                                <ng-select [multiple]="true">
                                  <div *ngFor="let it of quiz.questions; let idt = index">
                                    <ng-option *ngIf="configModalQuestion.idQuestionFilter < it.id" [innerHTML]="'<b>'+it.id+'</b>'+it.description" [value]="it.description"></ng-option>
                                  </div>
                                </ng-select>
                              </div>
                            </div>
                          </div>
                        </div>
  
                      </div>
   
                    </div>
  
                  </div>
                  <div class="tab-pane tap-conf fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">

                    <h3>Tipo de Alerta</h3>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" id="response_alert" name="response_alert" value="response" (change)="configModalQuestion.typeAlert = 'response'" [checked]="configModalQuestion.typeAlert == 'response'" ngModel>
                      <label class="form-check-label" for="response_alert">Alerta por Respuesta</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" id="accumulated_alert" name="accumulated_alert" value="accumulated" (change)="configModalQuestion.typeAlert = 'accumulated'" [checked]="configModalQuestion.typeAlert == 'accumulated'" ngModel>
                      <label class="form-check-label" for="accumulated_alert">Alerta por acumulado</label>
                    </div>

                  <div *ngIf="configModalQuestion.typeAlert == 'response'" class="cont-input">

                    <div class="col-sm-12">
                      <div class="row">
                        <div class="col-sm-12">
                          <p class="mini-txt">Los campos configurados a continuación saldrán antes de comenzar la encuesta </p>
                        </div>
                      </div>

                      <div class="row  mt-4 cont-item-alert" *ngFor="let dat of configModalQuestion.items">
                        
                        <div class="col-sm-2">
                          <div class="tit">Valor</div>
                          {{ dat.name }}
                        </div>

                        <div class="col-sm-3">
                          <div class="tit">Tipo de Alerta</div>
                          <select class="form-control" id="exampleFormControlSelect1">          
                            <option selected>Seleccionar</option>
                            <option >SMS</option>
                            <option >E-mail</option>
                          </select>
                        </div>

                        <div class="col-sm-2">
                          <div class="tit">Usuario</div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="typeUser" name="typeUser" value="admin"   >
                            <label class="form-check-label" for="typeUser">Administrador</label>
                          </div>
                          <div class="form-check form-check-inline" *ngIf="configModalQuestion.typeDesign != 'message'">
                            <input class="form-check-input" type="radio" id="typeUser2" name="typeUser" value="user" >
                            <label class="form-check-label" for="typeUser2">Usuario</label>
                          </div>
                        </div>

                        <div class="col-sm-12">
                          <div class="tit">Mensaje</div>
                          <ckeditor id="datasubmit" [editor]="Editor" required></ckeditor>
                        </div>

                      </div>

                    </div>

                  </div>

                  <div *ngIf="configModalQuestion.typeAlert == 'accumulated'" class="cont-input">

                    <div class="col-sm-12">
                      <div class="row">
                        <div class="col-sm-12">
                          <p class="mini-txt">Los campos configurados a continuación saldrán antes de comenzar la encuesta </p>
                        </div>
                      </div>

                      <div class="row  mt-4 cont-item-alert" *ngFor="let dat of configModalQuestion.items">
                        
                        <div class="col-sm-2">
                          <div class="tit">Valor</div>
                          {{ dat.name }}
                        </div>

                        <div class="col-sm-3">
                          <div class="tit">% acumulado</div>
                          <input name="acum" class="form-control">
                        </div>

                        <div class="col-sm-3">
                          <div class="tit">Tipo de Alerta</div>
                          <select class="form-control" id="exampleFormControlSelect1">          
                            <option selected>Seleccionar</option>
                            <option >SMS</option>
                            <option >E-mail</option>
                          </select>
                        </div>

                        <div class="col-sm-2">
                          <div class="tit">Usuario</div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="typeUser" name="typeUser" value="admin"   >
                            <label class="form-check-label" for="typeUser">Administrador</label>
                          </div>
                          <div class="form-check form-check-inline" *ngIf="configModalQuestion.typeDesign != 'message'">
                            <input class="form-check-input" type="radio" id="typeUser2" name="typeUser" value="user" >
                            <label class="form-check-label" for="typeUser2">Usuario</label>
                          </div>
                        </div>

                        <div class="col-sm-12">
                          <div class="tit">Mensaje</div>
                          <ckeditor id="datasubmit" [editor]="Editor" required></ckeditor>
                        </div>

                      </div>

                    </div>

                  </div>

                  </div>
               
                </div>
              </div>
            </div>
      
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary" >Seleccionar</button>
              <div  data-dismiss="modal" #closeBtn></div>
            </div>
          </div>
        </div>
      
      </form>
      
      </div>


</div>
<div class="d-flex justify-content-center load-comp" *ngIf="loading == true">
  <div class="spinner-border" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>